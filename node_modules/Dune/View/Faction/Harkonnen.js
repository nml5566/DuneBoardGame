module.exports = HarkonnenView;

var FactionDecorator = require("./Base");
var gameView = require("Dune/View/Game");
var eventChain = require("Dune/EventChain");
var TraitorSelect = require("../TraitorSelect.js");

function HarkonnenView() {


  var traitorImages;
  var traitorSelect = new TraitorSelect();

  traitorSelect.selectTraitor = function(canvas, element) {
    traitorImages = canvas.elements;

    traitorSelect.selectTraitorImage(traitorImages.shift());
  }

  var priv = {};

  var images = {
    "troop": "harkonnen.png",
    "leaderPath": "/img/leaders/harkonnen/",
    "leaders": [ "beast_rabban.png", "captain_iakin_nefud.png", "feyd_rautha.png", 
      "piter_de_vries.png", "umman_kudu.png" ],
    "emblem": "harkonnen-53x53.png"
  };

  FactionDecorator(this, {
    "faction": gameView.players['Harkonnen'],
    "private": priv,
    "traitorSelect": traitorSelect,
    "images": images
  });

  var playerScreen = priv.playerScreen;

  var obj = this;

  this.setupEventChain = function() {
    eventChain.add([
      function() { obj.promptUserSelectTraitor() },
      function() { playerScreen.addTraitorCard(obj.dealtCard()) },
      function() { traitorSelect.selectTraitorImage(traitorImages.shift()) },
      function() { playerScreen.addTraitorCard(obj.dealtCard()) },
      function() { traitorSelect.selectTraitorImage(traitorImages.shift()) },
      function() { playerScreen.addTraitorCard(obj.dealtCard()) },
      function() { traitorSelect.selectTraitorImage(traitorImages.shift()) },
      function() { playerScreen.addTraitorCard(obj.dealtCard()) },
      function() { obj.drawTreacheryCard() },
      function() { playerScreen.addTreacheryCard(obj.dealtCard()) },
      function() { obj.drawTreacheryCard() },
      function() { playerScreen.addTreacheryCard(obj.dealtCard()) },
      function() { obj.shipInitialTroops() }
    ]);
  }

}
