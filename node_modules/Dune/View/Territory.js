var Loader = require("Dune/Loader");
var canvasContainer = require("Dune/CanvasContainer");
var mapView = require("Dune/View/Map");

//var polarSink = require("Dune/View/Territory/PolarSink");
var BaseTerritoryView = require("Dune/View/Territory/Base");

module.exports = new TerritoryView()

function TerritoryView() 
{
  var loader = new Loader();

  var territoryImages = {
    "carthag": new BaseTerritoryView("carthag"),
    "arrakeen": new BaseTerritoryView("arrakeen"),
    "falseWallEast": new BaseTerritoryView("falseWallEast"),
    "polarSink": new BaseTerritoryView("polarSink")
  };

  var that = this;

  addClickEventToImageMap();

  function addClickEventToImageMap() 
  {
    var areaTags = document.getElementsByTagName("area");

    for (var i = 0; i < areaTags.length; i++) {
      var areaTag = areaTags[i];
      areaTag.addEventListener('click', function(e) {
      	var territoryName = this.target;
	that.enlargeTerritory(this);
      });
    }
  }
  
  this.getTerritory = function(territoryName) {
    var territoryObj = territoryImages[territoryName];

    if (! territoryObj) 
      throw new Error("No territory " + territoryName);


    return territoryObj;

  }

  this.enlargeTerritory = function(areaTag) 
  {
    var territoryName = areaTag.target;
    var territoryObj = territoryImages[territoryName];

    if (! territoryObj) 
      throw new Error("No territory " + territoryName);

    territoryObj.enlarge(areaTag);

    return territoryObj;
  }

}
