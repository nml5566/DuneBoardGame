var shuffleArray = require("Dune/shuffle");

module.exports = new TreacheryDeck();

function TreacheryDeck() {

  var cards = makeDeck();

  function makeDeck() 
  {
    var regularCards = new Array(
      "baliset", "chaumas", "chaumurky", "chrysknife", "cheapheroine", 
      "ellacadrug", "familyatomics", "gomjabbar", "hajr", 
      "harvester", "jubbacloak", "kulon", "lalala", "lasgun", 
      "maulapistol", "sliptip", "stunner", "thumper", "tleilaxughola", 
      "triptogamont", "weathercontrol"
    );

    var duplicateCards = new Array(
      Array.apply(null, new Array(4)).map(function() { return "shield" }),
      Array.apply(null, new Array(4)).map(function() { return "snooper" }),
      Array.apply(null, new Array(2)).map(function() { return "cheaphero" }),
      Array.apply(null, new Array(2)).map(function() { return "karama" })
    );

    var cards = regularCards;
    for (var i = 0; i < duplicateCards.length; i++) 
    {
      var duplicateCardArray = duplicateCards[i];
      cards = cards.concat(duplicateCardArray);
    }

    shuffleArray(cards);
    return cards;
  }

  this.dealCard = function() 
  {
    if (!cards.length) cards = makeDeck();

    return cards.shift();
  }
}

